generator client {
  provider   = "prisma-client"
  output     = "../lib/generated/prisma"
  engineType = "client" // enable Prisma ORM without Rust
}

datasource db {
  provider = "sqlite" //"postgresql"
}

model User {
  id         Int        @id @default(autoincrement())
  username   String     @unique
  email      String?    @unique
  password   String?
  //phone      String?    @unique
  //github_id  String?    @unique
  avatar     String?
  created_at DateTime   @default(now())
  updated_at DateTime   @updatedAt
  //tokens     SMSToken[]
  //products   Product[]
  //likes      Like[]
  //chat_rooms ChatRoom[]
  //messages   Message[]
  posts      Posts[]
  comments   Comments[]
  likes      Likes[]
}

model Posts {
  id         Int      @id @default(autoincrement())
  title      String
  content    String
  views      Int      @default(0)
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user   User @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId Int

  comments Comments[]
  likes    Likes[]
}

model Comments {
  id         Int      @id @default(autoincrement())
  content    String
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user   User  @relation(fields: [userId], references: [id], onDelete: Cascade)
  post   Posts @relation(fields: [postId], references: [id], onDelete: Cascade)
  userId Int
  postId Int
}

model Likes {
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user   User  @relation(fields: [userId], references: [id], onDelete: Cascade)
  post   Posts @relation(fields: [postId], references: [id], onDelete: Cascade)
  userId Int
  postId Int

  @@id(name: "id", [userId, postId])
}
